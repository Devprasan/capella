var capella=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uploadUrl="/upload",this.uploadFileButton=document.getElementById("uploadFileButton"),this.uploadLinkField=document.getElementById("uploadLinkField"),this.uploadFileButton&&this.uploadFileButton.addEventListener("click",this.uploadByTransport.bind(this),!1),this.uploadLinkField&&this.uploadLinkField.addEventListener("keydown",this.uploadByUrl.bind(this),!1)}return r(e,[{key:"uploadByTransport",value:function(){capella.transport.init({url:this.uploadUrl,multiple:!1,accept:"image/png, image/gif, image/jpg, image/jpeg, image/bmp,  image/tiff",data:{},before:this.before,progress:this.progress,success:this.success,error:this.error,after:this.after})}},{key:"uploadByUrl",value:function(e){13===e.keyCode&&(e.preventDefault(),this.uploadLinkField&&this.upload({link:this.uploadLinkField.value}))}},{key:"uploadBlob",value:function(e){var t=new FormData;this.currentFileName=e.name,t.append("file",e,e.name),this.upload(t)}},{key:"upload",value:function(e){capella.ajax.call({type:"POST",url:this.uploadUrl,data:e,before:this.before.bind(this),progress:this.progress,success:this.success,error:this.error,after:this.after})}},{key:"before",value:function(e){var t=void 0;e instanceof FormData&&(t=this.currentFileName),e&&e.link&&(t=e.link),e[0]instanceof File&&(t=e[0].name),capella.uploadScreen.show(t)}},{key:"progress",value:function(e){e*=.95,capella.uploadScreen.progress(e)}},{key:"success",value:function(e){console.log(e),e.success?(capella.uploadScreen.progress(100),window.location.href="/image/"+e.id):capella.uploadScreen.hide()}},{key:"error",value:function(e){capella.notifier.show({message:"<i class='cdx-notify__warning-sign'></i>"+e.message,time:7e3}),capella.uploadScreen.hide()}},{key:"after",value:function(){}}]),e}();t.default=a},function(e,t){var n=function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,n){"use strict";e.exports=function(){var e="cdx-notifies",t="cdx-notify",n="cdx-notify__cross",r="cdx-notify__button--confirm",a="cdx-notify__button--cancel",o="cdx-notify__input",i="cdx-notify__button",c="cdx-notify__btns-wrapper",u=function(e){var r=document.createElement("DIV"),a=document.createElement("DIV"),o=e.message,i=e.style;return r.classList.add(t),i&&r.classList.add(t+"--"+i),r.innerHTML=o,a.classList.add(n),a.addEventListener("click",r.remove.bind(r)),r.appendChild(a),r};return{alert:u,confirm:function(e){var t=u(e),o=document.createElement("div"),l=document.createElement("button"),s=document.createElement("button"),d=t.querySelector(n),p=e.cancelHandler,f=e.okHandler;return o.classList.add(c),l.innerHTML=e.okText||"Confirm",s.innerHTML=e.cancelText||"Cancel",l.classList.add(i),s.classList.add(i),l.classList.add(r),s.classList.add(a),p&&"function"==typeof p&&(s.addEventListener("click",p),d.addEventListener("click",p)),f&&"function"==typeof f&&l.addEventListener("click",f),l.addEventListener("click",t.remove.bind(t)),s.addEventListener("click",t.remove.bind(t)),o.appendChild(l),o.appendChild(s),t.appendChild(o),t},prompt:function(e){var t=u(e),a=document.createElement("div"),l=document.createElement("button"),s=document.createElement("input"),d=t.querySelector(n),p=e.cancelHandler,f=e.okHandler;return a.classList.add(c),l.innerHTML=e.okText||"Ok",l.classList.add(i),l.classList.add(r),s.classList.add(o),e.placeholder&&s.setAttribute("placeholder",e.placeholder),e.default&&(s.value=e.default),e.inputType&&(s.type=e.inputType),p&&"function"==typeof p&&d.addEventListener("click",p),f&&"function"==typeof f&&l.addEventListener("click",function(){f(s.value)}),l.addEventListener("click",t.remove.bind(t)),a.appendChild(s),a.appendChild(l),t.appendChild(a),t},wrapper:function(){var t=document.createElement("DIV");return t.classList.add(e),t}}}()},function(e,t){},function(e,t,n){"use strict";e.exports=function(){n(1);var e=n(0),t="cdx-notify--bounce-in",r=null;return{show:function(n){if(n.message){!function(){if(r)return!0;r=e.wrapper(),document.body.appendChild(r)}();var a=null,o=n.time||8e3;switch(n.type){case"confirm":a=e.confirm(n);break;case"prompt":a=e.prompt(n);break;default:a=e.alert(n),window.setTimeout(function(){a.remove()},o)}r.appendChild(a),a.classList.add(t)}}}}()}]);e.exports=n},function(e,t,n){"use strict";e.exports={init:function(){var e=window.navigator.userAgent;e.indexOf("Safari")>=0&&e.indexOf("Chrome")<0&&document.body.classList.add("safari")}}},function(e,t,n){"use strict";var r,a,o,i;e.exports=(r=".js-result__is-copied",a="js-hidden",o=document.querySelector(r),i=void 0,{toggleCopiedIcon:function(e){if(e.ctrlKey||e.metaKey||2===e.which)return!1;e.preventDefault(),i&&clearTimeout(i),o.classList.remove(a),i=setTimeout(function(){o.classList.add(a)},2e3)}})},function(e,t,n){"use strict";var r,a,o,i,c,u;e.exports=(r="js-copyable",a="js-copyable-authorize",o=function(e,t){e.addEventListener("click",u),e.addEventListener("copied",t)},i=function(e){e.addEventListener("click",c)},c=function(){this.querySelector("[name="+r+"]").click()},u=function(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(this),t.removeAllRanges(),t.addRange(n),document.execCommand("copy"),t.removeAllRanges();var r=new CustomEvent("copied",{bubbles:!1,cancelable:!1,detail:n.toString()});this.dispatchEvent(r),e.stopPropagation()},{init:function(e){var t=document.getElementsByName(r);if(t){for(var n=0;n<t.length;n++)o(t[n],e);for(var c=document.getElementsByName(a),u=0;u<c.length;u++)i(c[u]);console.log("Copyable module initialized"),this.clipboardButton=document.querySelector(".js-result__copy"),this.clipboardButton&&this.clipboardButton.addEventListener("click",capella.notificationToggler.toggleCopiedIcon,!0)}else console.log("There are no copyable elements")}})},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(1);e.exports=function(e){var t=null;e.input=null;var n=function(){t.before(e.input.files)},o=function(){var o=t.url,i=t.data,c=n,u=t.progress,l=t.success,s=t.error,d=t.after,p=new FormData,f=e.input.files;if(f.length>1)for(var v=0;v<f.length;v++)p.append("files[]",f[v],f[v].name);else p.append("file",f[0],f[0].name);if(null!==i&&"object"===(void 0===i?"undefined":r(i)))for(var h in i)p.append(h,i[h]);a.call({type:"POST",data:p,url:o,before:c,progress:u,success:l,error:s,after:d})};return e.init=function(n){if(n.url){t=n;var r=document.createElement("INPUT");r.type="file",t&&t.multiple&&r.setAttribute("multiple","multiple"),t&&t.accept&&r.setAttribute("accept",t.accept),r.addEventListener("change",o,!1),e.input=r,e.input.click()}else console.log("Can't send request because `url` is missed")},e}({})},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";e.exports={call:function(e){if(e&&e.url){var t=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),n=e.progress||null,r=e.success||function(){},a=e.error||function(){},o=e.before||null,i=e.after?e.after.bind(null,e.data):null;if(e.async=!0,e.type=e.type||"GET",e.data=e.data||"",e["content-type"]=e["content-type"]||"application/json; charset=utf-8","GET"===e.type&&e.data&&(e.url=/\?/.test(e.url)?e.url+"&"+e.data:e.url+"?"+e.data),e.withCredentials&&(t.withCredentials=!0),o&&"function"==typeof o&&!1===o(e.data))return;if(t.open(e.type,e.url,e.async),!function(e){return e instanceof FormData}(e.data)){var c=new FormData;for(var u in e.data)c.append(u,e.data[u]);e.data=c}n&&"function"==typeof n&&t.upload.addEventListener("progress",function(e){var t=parseInt(e.loaded/e.total*100);n(t)},!1),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onreadystatechange=function(){if(4===t.readyState){var e=t.responseText;try{e=JSON.parse(e)}catch(e){}200===t.status?r(e):a(e),i&&"function"==typeof i&&i()}},t.send(e.data)}}}}])}])},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";e.exports={call:function(e){if(e&&e.url){var t=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),n=e.progress||null,r=e.success||function(){},a=e.error||function(){},o=e.before||null,i=e.after?e.after.bind(null,e.data):null;if(e.async=!0,e.type=e.type||"GET",e.data=e.data||"",e["content-type"]=e["content-type"]||"application/json; charset=utf-8","GET"===e.type&&e.data&&(e.url=/\?/.test(e.url)?e.url+"&"+e.data:e.url+"?"+e.data),e.withCredentials&&(t.withCredentials=!0),o&&"function"==typeof o&&!1===o(e.data))return;if(t.open(e.type,e.url,e.async),!function(e){return e instanceof FormData}(e.data)){var c=new FormData;for(var u in e.data)c.append(u,e.data[u]);e.data=c}n&&"function"==typeof n&&t.upload.addEventListener("progress",function(e){var t=parseInt(e.loaded/e.total*100);n(t)},!1),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onreadystatechange=function(){if(4===t.readyState){var e=t.responseText;try{e=JSON.parse(e)}catch(e){}200===t.status?r(e):a(e),i&&"function"==typeof i&&i()}},t.send(e.data)}}}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mainContainer=document.querySelector(".capella"),this.progressBar=document.querySelector(".js-capella__uploading-progress"),this.loadingClass="capella--loading"}return r(e,[{key:"show",value:function(e){this.mainContainer.querySelector(".capella__uploading-filename").textContent=e,this.mainContainer.classList.add(this.loadingClass)}},{key:"hide",value:function(){this.mainContainer.classList.remove(this.loadingClass)}},{key:"progress",value:function(e){this.progressBar.style.width=e+"%"}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wrapper=document.querySelector(t),this.wrapper.addEventListener("dragenter",this.dragover.bind(this)),this.wrapper.addEventListener("dragover",this.dragover.bind(this)),this.wrapper.addEventListener("dragleave",this.drageleave.bind(this)),this.wrapper.addEventListener("drop",this.drop.bind(this))}return r(e,[{key:"dragover",value:function(e){e.preventDefault(),this.wrapper.classList.add("capella--dark")}},{key:"drageleave",value:function(e){e.preventDefault(),this.wrapper.classList.remove("capella--dark")}},{key:"drop",value:function(e){this.wrapper.classList.remove("capella--dark");var t=e.dataTransfer.files[0];capella.uploader.uploadBlob(t),e.preventDefault()}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pasteCatcher=null,window.Clipboard?document.body.addEventListener("paste",function(e){t.pasteHandler(e)}):(this.pasteCatcher=document.createElement("DIV"),this.pasteCatcher.setAttribute("contenteditable",!0),this.pasteCatcher.style.opacity=0,this.pasteCatcher.style.position="absolute",document.body.appendChild(this.pasteCatcher),document.body.addEventListener("paste",function(e){t.pasteCatcher.focus(),t.pasteHandler(e)}))}return r(e,[{key:"pasteHandler",value:function(e){var t=(e.clipboardData||e.originalEvent.clipboardData||window.clipboardData).getData("Text");if(t){e.preventDefault();if(t.match(/^((http[s]?):\/)?\/?([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+[^#?\s]+)(.*)?(#[\w\-]+)?$/))return void capella.uploader.upload({link:t});document.getElementById("uploadLinkField").value=t}this.pasteImageHandler(e)}},{key:"pasteImageHandler",value:function(e){var t=this;if(window.Clipboard){if(e.preventDefault(),!e.clipboardData)return;var n=e.clipboardData.items;if(n)for(var r=0;r<n.length;r++)if(-1!==n[r].type.indexOf("image")){var a=n[r].getAsFile();capella.uploader.uploadBlob(a);break}}else setTimeout(function(){return t.checkPasteCatcher()},50)}},{key:"checkPasteCatcher",value:function(){var e=this.pasteCatcher.querySelector("IMG");this.pasteCatcher.innerHTML="",e&&"IMG"===e.tagName&&this.createImage(e.src).then(function(e){return capella.uploader.uploadBlob(e)}).catch(console.log)}},{key:"createImage",value:function(e){var t=this;return new Promise(function(n,r){var a=new Image;a.onload=function(){t.loadXHR(e).then(n).catch(r)},a.src=e})}},{key:"loadXHR",value:function(e){return new Promise(function(t,n){try{var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onerror=function(){n("Network error.")},r.onload=function(){200===r.status?t(r.response):n("Loading error: "+r.statusText)},r.send()}catch(e){n(e.message)}})}}]),e}();t.default=a},function(e,t,n){"use strict";var r={},a=n(0).default,o=n(9).default,i=n(8).default,c=n(7).default;r.ajax=n(6),r.transport=n(5),r.uploader=n(0),r.copyable=n(4),r.notificationToggler=n(3),r.checkForSafari=n(2),r.notifier=n(1),r.uploadScreen=new c,r.uploader=new a,r.clipboard=new o,r.dnd=new i(".capella"),r.init=function(){r.copyable.init(),r.checkForSafari.init()},e.exports=r},function(e,t,n){"use strict";n(13),e.exports=n(10)},,function(e,t){}]);